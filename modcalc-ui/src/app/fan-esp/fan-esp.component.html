<html>
<header>
  <h3 class="text-center">Fan ESP</h3>
</header>
<div *ngIf="!dataAvailable" class="row">
  <div class="col"></div>
  <div class="col-sm-3" style="margin-top: 15%;">
    <mat-progress-bar mode="buffer"></mat-progress-bar>
  </div>
  <div class="col"></div>
</div>
<body *ngIf="dataAvailable && !resultAvailable">
<mat-expansion-panel expanded="true">
  <div class="data-border-rectangular">
    <u>Important Remark</u>
    <br>
    Most pipe sizing charts are based on Hazen-Williams equation. However, this web site calculates pressure drop using
    Darcy-Weisbach equation since
    the Hazen-Williams equation has narrow applicable ranges for Reynolds numbers and pipe sizes. The equation is valid
    for pipe sizes 3 in. (75 mm)
    and larger, for water flowing at temperatures of between 40° to 75oF (21° to 24°C) and pressures up to 175 psi (1.2
    MPa). The level of error when the
    Hazen-Williams equation is used outside its data ranges is significant.
  </div>
</mat-expansion-panel>
<div>
  <mat-expansion-panel expanded="true">
    <h6 style="font-weight: bold;">
      Fan Information
    </h6>
    <mat-expansion-panel expanded="true">
      <div>
        <div class="row">
          <mat-form-field class="col" style="width: 33%">
            <input type="text" matInput placeholder="Project" [(ngModel)]="request.pumpInformation.project">
          </mat-form-field>
          <mat-form-field class="col" style="width: 33%">
            <input type="text" matInput placeholder="System" [(ngModel)]="request.pumpInformation.system">
          </mat-form-field>
          <mat-form-field class="col" style="width: 33%">
            <input type="text" matInput placeholder="Fan Ref." [(ngModel)]="request.pumpInformation.pumpRef">
          </mat-form-field>
        </div>
      </div>
    </mat-expansion-panel>
  </mat-expansion-panel>
  <br>
  <mat-expansion-panel expanded="true">
    <div>
      <div class="row">
        <div class="col-sm-4">
          <mat-expansion-panel expanded="true">
            <h6 style="font-weight: bold">Units</h6>
            <mat-expansion-panel expanded="true">
              <div>
                <div class="row">
                  <mat-form-field class="col" style="width: 33%">
                    <mat-select placeholder="Unit System" [(ngModel)]="request.units.uu"
                                (selectionChange)="this.setRelatedData(request.units.uu)">
                      <mat-option *ngFor="let unitSystem of unitSystemList" [value]="unitSystem.value">
                        {{unitSystem.key}}
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
                  <mat-form-field class="col" style="width: 33%">
                    <mat-select placeholder="Flow Rate" [(ngModel)]="request.units.uf">
                      <mat-option *ngFor="let flowRate of flowRateList" [value]="flowRate.value"
                                  [innerHtml]="flowRate.key.replace('^', '&sup')">-->
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
                  <mat-form-field class="col" style="width: 33%">
                    <mat-select placeholder="Length" [(ngModel)]="request.units.ul">
                      <mat-option *ngFor="let length of lengthList" [value]="length.value"
                                  [innerHtml]="length.key.replace('^', '&sup')">
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
              </div>
            </mat-expansion-panel>
          </mat-expansion-panel>
        </div>
        <div class="col-sm-3">
          <mat-expansion-panel expanded="true">
            <h6 style="font-weight: bold">Air Temperature</h6>
            <mat-expansion-panel expanded="true">
              <div>
                <div class="row">
                  <mat-form-field class="col" style="width: 50%">
                    <input type="number" step="any" matInput placeholder="Air Temperature"
                           [(ngModel)]="request.airTemperature.temperatureInput"
                           temperatureInputValidator
                           #temperatureInput="ngModel">
                    <mat-error *ngIf="temperatureInput.errors">
                      Temperature Is Invalid
                    </mat-error>
                  </mat-form-field>
                  <mat-dialog-content class="col" style="width: 50%">
                    <br>
                    <div [innerHtml]="temperatureUnit.key.replace('^', '&sup')"></div>
                  </mat-dialog-content>
                </div>
              </div>
            </mat-expansion-panel>
          </mat-expansion-panel>
        </div>
        <div class="col">
          <mat-expansion-panel expanded="true">
            <h6 style="font-weight: bold">Duct Type</h6>
            <mat-expansion-panel expanded="true">
              <div>
                <div class="row">
                  <mat-form-field class="col" style="width: 100%">
                    <mat-select placeholder="Duct Material" [(ngModel)]="request.ductType.eps">
                      <mat-option *ngFor="let ductMaterial of ductMaterialList" [value]="ductMaterial.value"
                                  [innerHtml]="ductMaterial.key">
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
              </div>
            </mat-expansion-panel>
          </mat-expansion-panel>
        </div>
      </div>
      <div class="row">
        <div class="col">
          <mat-expansion-panel expanded="true">
            <mat-expansion-panel-header>
              <mat-panel-title>
                <h6 style="font-weight: bold">Duct Sections</h6>
              </mat-panel-title>
            </mat-expansion-panel-header>
            <div *ngFor="let ductSection of request.ductSectionList;let i = index">
              <mat-expansion-panel expanded="true">
                <mat-expansion-panel-header>
                  <mat-panel-title>
                    Duct Section #{{i+1}}
                  </mat-panel-title>
                </mat-expansion-panel-header>
                <div class="row">
                  <div class="col" style="width: 25%"></div>
                  <mat-form-field class="col" style="width: 50%">
                    <input type="text" matInput placeholder="Section Id"
                           [(ngModel)]="ductSection.ductSectionId"
                           nullInputValidator
                           #ductSectionId="ngModel">
                    <mat-error *ngIf="ductSectionId.errors">
                      Duct Section Id Is Invalid
                    </mat-error>
                  </mat-form-field>
                  <div class="col" style="width: 25%"></div>
                </div>
                <div class="row">
                  <mat-form-field class="col" style="width: 16.5%">
                    <input type="number" step="any" matInput placeholder="Flow Rate"
                           [(ngModel)]="ductSection.rateInput"
                           ductFlowRateInputValidator
                           #ductFanRateInput="ngModel">
                    <mat-error *ngIf="ductFanRateInput.errors">
                      Fan Rate Is Invalid
                    </mat-error>
                  </mat-form-field>
                  <mat-dialog-content class="col" style="width: 16.5%">
                    <br>
                    <div [innerHtml]="this.getFlowRateKey(request.units.uf,ductSection).replace('^', '&sup')"></div>
                  </mat-dialog-content>
                  <mat-form-field class="col" style="width: 16.5%">
                    <input type="number" step="any" matInput placeholder="Length"
                           [(ngModel)]="ductSection.lengthInput"
                           ductLengthInputValidator
                           #ductLengthInput="ngModel">
                    <mat-error *ngIf="ductLengthInput.errors">
                      Length Is Invalid
                    </mat-error>
                  </mat-form-field>
                  <mat-dialog-content class="col" style="width: 16.5%">
                    <br>
                    <div [innerHtml]="this.getLengthKey(request.units.ul,ductSection).replace('^', '&sup')"></div>
                  </mat-dialog-content>
                  <mat-form-field class="col" style="width: 16.5%">
                    <mat-select placeholder="Duct Shape" [(ngModel)]="ductSection.shp"
                                (change)="this.changeDuctSectionShp(ductSection)">
                      <mat-option *ngFor="let ductShape of ductShapeList" [value]="ductShape.value"
                                  [innerHtml]="ductShape.key">
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
                  <mat-form-field class="col" style="width: 16.5%">
                    <mat-select placeholder="Function" [(ngModel)]="ductSection.fun"
                                (change)="this.changeDuctSectionFun(ductSection)">
                      <mat-option *ngFor="let function of functionList" [value]="function.value"
                                  [innerHtml]="function.key">
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
                <div class="row">
                  <div *ngIf="ductSection.shp == 1" class="col" style="width: 12.5%"></div>
                  <div *ngIf="ductSection.shp == 1" class="col" style="width: 12.5%"></div>
                  <mat-form-field *ngIf="ductSection.shp == 2" class="col" style="width: 12.5%">
                    <input type="number" step="any" matInput placeholder="Duct Diameter"
                           [(ngModel)]="ductSection.ductDiameterInput"
                           ductDiameterInputValidator
                           #ductDiameter="ngModel">
                    <mat-error *ngIf="ductDiameter.errors">
                      Diameter Is Invalid
                    </mat-error>
                  </mat-form-field>
                  <mat-dialog-content class="col" *ngIf="ductSection.shp == 2" style="width: 12.5%">
                    <br>
                    <div [innerHtml]="this.getDimensionUnit(ductSection).replace('^', '&sup')"></div>
                  </mat-dialog-content>
                  <div *ngIf="ductSection.shp == 2" class="col" style="width: 12.5%"></div>
                  <div *ngIf="ductSection.shp == 2" class="col" style="width: 12.5%"></div>
                  <mat-form-field *ngIf="ductSection.shp == 1" class="col" style="width: 12.5%">
                    <input type="number" step="any" matInput placeholder="Duct Width"
                           [(ngModel)]="ductSection.ductWidthInput"
                           ductHeightWidthInputValidator
                           #ductWidth="ngModel">
                    <mat-error *ngIf="ductWidth.errors">
                      Width Is Invalid
                    </mat-error>
                  </mat-form-field>
                  <mat-dialog-content class="col" *ngIf="ductSection.shp == 1" style="width: 12.5%">
                    <br>
                    <div [innerHtml]="this.getDimensionUnit(ductSection).replace('^', '&sup')"></div>
                  </mat-dialog-content>
                  <div *ngIf="ductSection.shp == 2" class="col" style="width: 12.5%"></div>
                  <div *ngIf="ductSection.shp == 2" class="col" style="width: 12.5%"></div>
                  <mat-form-field *ngIf="ductSection.shp == 1" class="col" style="width: 12.5%">
                    <input type="number" step="any" matInput placeholder="Duct Height"
                           [(ngModel)]="ductSection.ductHeightInput"
                           ductHeightWidthInputValidator
                           #ductHeight="ngModel">
                    <mat-error *ngIf="ductHeight.errors">
                      Height Is Invalid
                    </mat-error>
                  </mat-form-field>
                  <mat-dialog-content class="col" *ngIf="ductSection.shp == 1" style="width: 12.5%">
                    <br>
                    <div [innerHtml]="this.getDimensionUnit(ductSection).replace('^', '&sup')"></div>
                  </mat-dialog-content>
                  <mat-form-field class="col" style="width: 12.5%">
                    <input type="number" step="any" matInput placeholder="Duct Thickness"
                           [(ngModel)]="ductSection.ductThicknessInput"
                           ductThicknessInputValidator
                           #ductThickness="ngModel">
                    <mat-error *ngIf="ductThickness.errors">
                      Thickness Is Invalid
                    </mat-error>
                  </mat-form-field>
                  <mat-dialog-content class="col" style="width: 12.5%">
                    <br>
                    <div [innerHtml]="this.getDimensionUnit(ductSection).replace('^', '&sup')"></div>
                  </mat-dialog-content>
                </div>
                <mat-expansion-panel expanded="true">
                  Fittings
                  <div *ngFor="let fitting of ductSection.fittingList;let i = index">
                    <mat-expansion-panel expanded="true">
                      <mat-expansion-panel-header>
                        <mat-panel-title>
                          Fitting #{{i+1}}
                        </mat-panel-title>
                      </mat-expansion-panel-header>
                      <mat-radio-group class="row">
                        <mat-radio-button [checked]="fitting.fittingSizingCriteria==1"
                                          [value]="fitting.fittingSizingCriteria==1"
                                          class="col"
                                          (click)="this.setFittingCriteria(fitting,1)">
                          Using ASHRAE fittings database
                        </mat-radio-button>
                        <div class="col-sm-1"></div>
                        <mat-radio-button [checked]="fitting.fittingSizingCriteria==2"
                                          [value]="fitting.fittingSizingCriteria==2" class="col"
                                          (click)="this.setFittingCriteria(fitting,2)">
                          User-Defined
                        </mat-radio-button>
                      </mat-radio-group>
                      <div class="row">
                        <div class="col">
                          <mat-form-field *ngIf="fitting.fittingSizingCriteria == 1" style="width: 100%;">
                            <mat-select placeholder="Category" [(ngModel)]="fitting.cat"
                                        (selectionChange)="this.changeFittingCat(fitting)">
                              <mat-option *ngFor="let category of this.getCategoryList(ductSection.fun)"
                                          [value]="category.value">
                                {{category.key}}
                              </mat-option>
                            </mat-select>
                          </mat-form-field>
                          <div class="row">
                            <mat-form-field class="col" *ngIf="fitting.fittingSizingCriteria == 1">
                              <textarea type="text" matTextareaAutosize
                                        matInput readonly placeholder="Type"
                                        [(ngModel)]="fitting.fittingDescription"></textarea>
                            </mat-form-field>
                            <button mat-raised-button class="col-sm-4" *ngIf="fitting.fittingSizingCriteria == 1"
                                    (click)="this.chooseFittingType(ductSection,fitting)">Select Type
                            </button>
                          </div>
                          <br>
                          <div class="row">
                            <mat-form-field class="col" *ngIf="fitting.fittingSizingCriteria == 1">
                              <input type="text" matInput readonly placeholder="Co"
                                     [(ngModel)]="fitting.cf">
                            </mat-form-field>
                            <button mat-raised-button class="col-sm-4" *ngIf="fitting.fittingSizingCriteria == 1"
                                    (click)="this.chooseFittingCoefficient(fitting)"
                                    [disabled]="fitting.fittingDescription == null">Select Coefficient
                            </button>
                          </div>
                          <mat-form-field *ngIf="fitting.fittingSizingCriteria == 1" style="width: 100%;">
                            <input type="number" step="any" matInput placeholder="Qty"
                                   [(ngModel)]="fitting.qf"
                                   nullInputValidator
                                   #fittingQf="ngModel">
                            <mat-error *ngIf="fittingQf.errors">
                              Qty Is Invalid
                            </mat-error>
                          </mat-form-field>
                        </div>
                        <div class="col-sm-1"></div>
                        <div class="col">
                          <mat-form-field *ngIf="fitting.fittingSizingCriteria == 2" style="width: 100%">
                            <textarea type="text" matTextareaAutosize matInput placeholder="Description"
                                      [(ngModel)]="fitting.fittingDescription"
                                      nullInputValidator
                                      #fittingDescription="ngModel"></textarea>
                            <mat-error *ngIf="fittingDescription.errors">
                              Description Is Invalid
                            </mat-error>
                          </mat-form-field>
                          <mat-form-field *ngIf="fitting.fittingSizingCriteria == 2" style="width: 100%">
                            <input type="number" step="any" matInput placeholder="loss coefficient (C)"
                                   [(ngModel)]="fitting.cf"
                                   nullInputValidator
                                   #fittingCf="ngModel">
                            <mat-error *ngIf="fittingCf.errors">
                              Loss Coefficient Is Invalid
                            </mat-error>
                          </mat-form-field>
                          <mat-form-field *ngIf="fitting.fittingSizingCriteria == 2" style="width: 100%">
                            <input type="number" step="any" matInput placeholder="Qty"
                                   [(ngModel)]="fitting.qf"
                                   nullInputValidator
                                   #fittingQf="ngModel">
                            <mat-error *ngIf="fittingQf.errors">
                              Qty Is Invalid
                            </mat-error>
                          </mat-form-field>
                        </div>
                      </div>
                      <br>
                      <div id="inner-button" class="row">
                        <button mat-raised-button color="warn"
                                type="submit" (click)="this.removeFitting(ductSection,i)">
                          Remove Fitting
                        </button>
                      </div>
                    </mat-expansion-panel>
                  </div>
                  <br>
                  <div id="inner-button" class="row">
                    <button mat-raised-button type="submit"
                            (click)="this.addFitting(ductSection)">
                      Add New Fitting
                    </button>
                  </div>
                </mat-expansion-panel>
                <mat-expansion-panel expanded="true">
                  Dampers & Obstructions
                  <div *ngFor="let dampersAndObstructions of ductSection.dampersAndObstructionsList;let i = index">
                    <mat-expansion-panel expanded="true">
                      <mat-expansion-panel-header>
                        <mat-panel-title>
                          Dampers & Obstructions #{{i+1}}
                        </mat-panel-title>
                      </mat-expansion-panel-header>
                      <mat-radio-group class="row">
                        <mat-radio-button [checked]="dampersAndObstructions.dampersAndObstructionsSizingCriteria==1"
                                          [value]="dampersAndObstructions.dampersAndObstructionsSizingCriteria==1"
                                          class="col"
                                          (click)="setDampersAndObstructionsCriteria(dampersAndObstructions,1)">
                          Using ASHRAE fittings database
                        </mat-radio-button>
                        <div class="col-sm-1"></div>
                        <mat-radio-button [checked]="dampersAndObstructions.dampersAndObstructionsSizingCriteria==2"
                                          [value]="dampersAndObstructions.dampersAndObstructionsSizingCriteria==2"
                                          class="col"
                                          (click)="setDampersAndObstructionsCriteria(dampersAndObstructions,2)">
                          User-Defined
                        </mat-radio-button>
                      </mat-radio-group>
                      <div class="row">
                        <div class="col">
                          <div class="row">
                            <mat-form-field class="col"
                                            *ngIf="dampersAndObstructions.dampersAndObstructionsSizingCriteria == 1">
                              <textarea type="text" matTextareaAutosize matInput readonly placeholder="Type"
                                        [(ngModel)]="dampersAndObstructions.dampersAndObstructionsDescription">
                              </textarea>
                            </mat-form-field>
                            <button mat-raised-button class="col-sm-4"
                                    *ngIf="dampersAndObstructions.dampersAndObstructionsSizingCriteria == 1"
                                    (click)="this.chooseDampersAndObstructionsType(ductSection,dampersAndObstructions)">
                              Select Type
                            </button>
                          </div>
                          <br>
                          <div class="row">
                            <mat-form-field class="col"
                                            *ngIf="dampersAndObstructions.dampersAndObstructionsSizingCriteria == 1">
                              <input type="text" matInput readonly placeholder="Co"
                                     [(ngModel)]="dampersAndObstructions.cd">
                            </mat-form-field>
                            <button mat-raised-button class="col-sm-4"
                                    *ngIf="dampersAndObstructions.dampersAndObstructionsSizingCriteria == 1"
                                    (click)="this.chooseDampersAndObstructionsCoefficient(dampersAndObstructions)"
                                    [disabled]="dampersAndObstructions.dampersAndObstructionsDescription == null">Select
                              Coefficient
                            </button>
                          </div>
                          <mat-form-field *ngIf="dampersAndObstructions.dampersAndObstructionsSizingCriteria == 1"
                                          style="width: 100%;">
                            <input type="number" step="any" matInput placeholder="Qty"
                                   [(ngModel)]="dampersAndObstructions.qd"
                                   nullInputValidator
                                   #dampersAndObstructionsQd="ngModel">
                            <mat-error *ngIf="dampersAndObstructionsQd.errors">
                              Qty Is Invalid
                            </mat-error>
                          </mat-form-field>
                        </div>
                        <div class="col-sm-1"></div>
                        <div class="col">
                          <mat-form-field *ngIf="dampersAndObstructions.dampersAndObstructionsSizingCriteria == 2"
                                          style="width: 100%">
                            <textarea type="text" matTextareaAutosize matInput placeholder="Description"
                                      [(ngModel)]="dampersAndObstructions.dampersAndObstructionsDescription"
                                      nullInputValidator
                                      #dampersAndObstructionsDescription="ngModel">
                            </textarea>
                            <mat-error *ngIf="dampersAndObstructionsDescription.errors">
                              Description Is Invalid
                            </mat-error>
                          </mat-form-field>
                          <mat-form-field *ngIf="dampersAndObstructions.dampersAndObstructionsSizingCriteria == 2"
                                          style="width: 100%">
                            <input type="number" step="any" matInput placeholder="loss coefficient (C)"
                                   [(ngModel)]="dampersAndObstructions.cd"
                                   nullInputValidator
                                   #dampersAndObstructionsCd="ngModel">
                            <mat-error *ngIf="dampersAndObstructionsCd.errors">
                              Loss Coefficient Is Invalid
                            </mat-error>
                          </mat-form-field>
                          <mat-form-field *ngIf="dampersAndObstructions.dampersAndObstructionsSizingCriteria == 2"
                                          style="width: 100%">
                            <input type="number" step="any" matInput placeholder="Qty"
                                   [(ngModel)]="dampersAndObstructions.qd"
                                   nullInputValidator
                                   #dampersAndObstructionsQd="ngModel">
                            <mat-error *ngIf="dampersAndObstructionsQd.errors">
                              Qty Is Invalid
                            </mat-error>
                          </mat-form-field>
                        </div>
                      </div>
                      <br>
                      <div id="inner-button" class="row">
                        <button mat-raised-button color="warn"
                                type="submit" (click)="this.removeDampersAndObstructions(ductSection,i)">
                          Remove Dampers/Obstruction
                        </button>
                      </div>
                    </mat-expansion-panel>
                  </div>
                  <br>
                  <div id="inner-button" class="row">
                    <button mat-raised-button
                            (click)="this.addDampersAndObstructions(ductSection)">Add New Dampers/Obstruction
                    </button>
                  </div>
                </mat-expansion-panel>
                <mat-expansion-panel expanded="true">
                  Duct-Mounted Equipment
                  <div *ngFor="let ductMountedEquipment of ductSection.ductMountedEquipmentList;let i = index">
                    <mat-expansion-panel expanded="true">
                      <mat-expansion-panel-header>
                        <mat-panel-title>
                          Duct-Mounted Equipment #{{i+1}}
                        </mat-panel-title>
                      </mat-expansion-panel-header>
                      <mat-radio-group class="row">
                        <mat-radio-button [checked]="ductMountedEquipment.ductMountedEquipmentCriteria==1"
                                          [value]="ductMountedEquipment.ductMountedEquipmentCriteria==1"
                                          class="col"
                                          (click)="this.setDuctMountedEquipmentCriteria(ductMountedEquipment,1)">
                          Using ASHRAE fittings database
                        </mat-radio-button>
                        <div class="col-sm-1"></div>
                        <mat-radio-button [checked]="ductMountedEquipment.ductMountedEquipmentCriteria==2"
                                          [value]="ductMountedEquipment.ductMountedEquipmentCriteria==2"
                                          class="col"
                                          (click)="this.setDuctMountedEquipmentCriteria(ductMountedEquipment,2)">
                          User-Defined
                        </mat-radio-button>
                      </mat-radio-group>
                      <div class="row">
                        <div class="col">
                          <div class="row">
                            <mat-form-field class="col"
                                            *ngIf="ductMountedEquipment.ductMountedEquipmentCriteria == 1">
                              <textarea type="text" matTextareaAutosize matInput readonly placeholder="Type"
                                        [(ngModel)]="ductMountedEquipment.ductMountedEquipmentDescription">
                              </textarea>
                            </mat-form-field>
                            <button mat-raised-button class="col-sm-4"
                                    *ngIf="ductMountedEquipment.ductMountedEquipmentCriteria == 1"
                                    (click)="this.chooseDuctMountedEquipmentType(ductSection,ductMountedEquipment)">
                              Select Type
                            </button>
                          </div>
                          <br>
                          <div class="row">
                            <mat-form-field class="col"
                                            *ngIf="ductMountedEquipment.ductMountedEquipmentCriteria == 1">
                              <input type="text" matInput readonly placeholder="Co"
                                     [(ngModel)]="ductMountedEquipment.ce">
                            </mat-form-field>
                            <button mat-raised-button class="col-sm-4"
                                    *ngIf="ductMountedEquipment.ductMountedEquipmentCriteria == 1"
                                    (click)="this.chooseDuctMountedEquipmentCoefficient(ductMountedEquipment)"
                                    [disabled]="ductMountedEquipment.ductMountedEquipmentDescription == null">Select
                              Coefficient
                            </button>
                          </div>
                          <mat-form-field *ngIf="ductMountedEquipment.ductMountedEquipmentCriteria == 1"
                                          style="width: 100%;">
                            <input type="number" step="any" matInput placeholder="Qty"
                                   [(ngModel)]="ductMountedEquipment.qe"
                                   nullInputValidator
                                   #ductMountedEquipmentQe="ngModel">
                            <mat-error *ngIf="ductMountedEquipmentQe.errors">
                              Qty Is Invalid
                            </mat-error>
                          </mat-form-field>
                        </div>
                        <div class="col-sm-1"></div>
                        <div class="col">
                          <mat-form-field *ngIf="ductMountedEquipment.ductMountedEquipmentCriteria == 2"
                                          style="width: 100%">
                            <textarea type="text" matTextareaAutosize matInput placeholder="Description"
                                      [(ngModel)]="ductMountedEquipment.ductMountedEquipmentDescription"
                                      nullInputValidator
                                      #ductMountedEquipmentDescription="ngModel">
                            </textarea>
                            <mat-error *ngIf="ductMountedEquipmentDescription.errors">
                              Description Is Invalid
                            </mat-error>
                          </mat-form-field>
                          <mat-form-field *ngIf="ductMountedEquipment.ductMountedEquipmentCriteria == 2"
                                          style="width: 100%">
                            <input type="number" step="any" matInput placeholder="loss coefficient (C)"
                                   [(ngModel)]="ductMountedEquipment.ce"
                                   nullInputValidator
                                   #ductMountedEquipmentCe="ngModel">
                            <mat-error *ngIf="ductMountedEquipmentCe.errors">
                              Loss Coefficient Is Invalid
                            </mat-error>
                          </mat-form-field>
                          <mat-form-field *ngIf="ductMountedEquipment.ductMountedEquipmentCriteria == 2"
                                          style="width: 100%">
                            <input type="number" step="any" matInput placeholder="Qty"
                                   [(ngModel)]="ductMountedEquipment.qe"
                                   nullInputValidator
                                   #ductMountedEquipmentQe="ngModel">
                            <mat-error *ngIf="ductMountedEquipmentQe.errors">
                              Qty Is Invalid
                            </mat-error>
                          </mat-form-field>
                        </div>
                      </div>
                      <br>
                      <div id="inner-button" class="row">
                        <button mat-raised-button color="warn"
                                type="submit" (click)="this.removeEquipment(ductSection,i)">
                          Remove Equipment
                        </button>
                      </div>
                    </mat-expansion-panel>
                  </div>
                  <br>
                  <div id="inner-button" class="row">
                    <button mat-raised-button type="submit"
                            (click)="this.addEquipment(ductSection)">
                      Add New Equipment
                    </button>
                  </div>
                </mat-expansion-panel>
                <mat-expansion-panel expanded="true">
                  Special Components
                  <div *ngFor="let specialComponent of ductSection.specialComponentList;let i = index">
                    <mat-expansion-panel expanded="true">
                      <mat-expansion-panel-header>
                        <mat-panel-title>
                          Special Component #{{i+1}}
                        </mat-panel-title>
                      </mat-expansion-panel-header>
                      <div class="row">
                        <mat-form-field class="col" style="width: 25%">
                          <textarea type="text" matTextareaAutosize matInput placeholder="Description"
                                    [(ngModel)]="specialComponent.specialComponentDescription"
                                    nullInputValidator
                                    #specialComponentDescription="ngModel">
                          </textarea>
                          <mat-error *ngIf="specialComponentDescription.errors">
                            Description Is Invalid
                          </mat-error>
                        </mat-form-field>
                        <mat-form-field class="col" style="width: 25%">
                          <input type="number" step="any" matInput placeholder="Pressure loss"
                                 [(ngModel)]="specialComponent.componentPressureDropInput"
                                 nullInputValidator
                                 #componentPressureDropInput="ngModel">
                          <mat-error *ngIf="componentPressureDropInput.errors">
                            Pressure loss Is Invalid
                          </mat-error>
                        </mat-form-field>
                        <mat-dialog-content class="col" style="width: 25%">
                          <br>
                          <div [innerHtml]="this.getPressureUnit(specialComponent).replace('^', '&sup')"></div>
                        </mat-dialog-content>
                        <mat-form-field class="col" style="width: 25%">
                          <input type="number" step="any" matInput placeholder="Qty"
                                 [(ngModel)]="specialComponent.qc"
                                 nullInputValidator
                                 #specialComponentQc="ngModel">
                          <mat-error *ngIf="specialComponentQc.errors">
                            Qty Is Invalid
                          </mat-error>
                        </mat-form-field>
                      </div>
                      <br>
                      <div id="inner-button" class="row">
                        <button mat-raised-button color="warn"
                                type="submit" (click)="this.removeSpecialComponent(ductSection,i)">
                          Remove Component
                        </button>
                      </div>
                    </mat-expansion-panel>
                  </div>
                  <br>
                  <div id="inner-button" class="row">
                    <button mat-raised-button type="submit"
                            (click)="this.addSpecialComponent(ductSection)">Add New Component
                    </button>
                  </div>
                </mat-expansion-panel>
                <br>
                <div id="inner-button" class="row">
                  <button mat-raised-button color="warn"
                          type="submit" (click)="this.removeDuctSection(i)"
                          [disabled]="request.ductSectionList.length==1">
                    Remove Duct Section
                  </button>
                </div>
              </mat-expansion-panel>
            </div>
            <br>
            <div id="inner-button" class="row">
              <button mat-raised-button type="submit" (click)="this.addNewDuctSection()">Add
                New
                Duct Section
              </button>
            </div>
          </mat-expansion-panel>
        </div>
      </div>
      <div class="row">
        <div class="col">
          <mat-expansion-panel expanded="true">
            <h6 style="font-weight: bold;">Fan-system interaction</h6>
            <div *ngFor="let fanSystemInteraction of request.fanSystemInteractionList;let i = index">
              <mat-expansion-panel expanded="true">
                <mat-expansion-panel-header>
                  <mat-panel-title>
                    Fan-system interaction #{{i+1}}
                  </mat-panel-title>
                </mat-expansion-panel-header>
                <div>
                  <div class="row">
                    <div class="col" style="width: 33%"></div>
                    <mat-form-field class="col" style="width: 33%">
                      <mat-select placeholder="Section" [(ngModel)]="fanSystemInteraction.ductSection">
                        <mat-option *ngFor="let ductSection of this.getDuctSectionList(i)" [value]="ductSection">
                          {{ductSection}}
                        </mat-option>
                      </mat-select>
                    </mat-form-field>
                    <div class="col" style="width: 33%"></div>
                  </div>
                  <mat-radio-group class="row">
                    <mat-radio-button [checked]="fanSystemInteraction.fanSystemInteractionCriteria==1"
                                      [value]="fanSystemInteraction.fanSystemInteractionCriteria==1"
                                      class="col"
                                      (click)="this.setFanSystemInteractionCriteria(fanSystemInteraction,1)">
                      Using ASHRAE fittings database
                    </mat-radio-button>
                    <div class="col-sm-1"></div>
                    <mat-radio-button [checked]="fanSystemInteraction.fanSystemInteractionCriteria==2"
                                      [value]="fanSystemInteraction.fanSystemInteractionCriteria==2"
                                      class="col"
                                      (click)="this.setFanSystemInteractionCriteria(fanSystemInteraction,2)">
                      User-Defined
                    </mat-radio-button>
                  </mat-radio-group>
                  <div class="row">
                    <div class="col">
                      <div class="row">
                        <mat-form-field class="col"
                                        *ngIf="fanSystemInteraction.fanSystemInteractionCriteria == 1">
                          <textarea type="text" matTextareaAutosize matInput readonly placeholder="Type"
                                    [(ngModel)]="fanSystemInteraction.fanSystemInteractionDescription">
                          </textarea>
                        </mat-form-field>
                        <button mat-raised-button class="col-sm-4"
                                *ngIf="fanSystemInteraction.fanSystemInteractionCriteria == 1"
                                (click)="this.chooseFanSystemInteractionType(fanSystemInteraction)"
                                [disabled]="fanSystemInteraction.ductSection == null">
                          Select Type
                        </button>
                      </div>
                      <br>
                      <div class="row">
                        <mat-form-field class="col"
                                        *ngIf="fanSystemInteraction.fanSystemInteractionCriteria == 1">
                          <input type="text" matInput readonly placeholder="Co"
                                 [(ngModel)]="fanSystemInteraction.ci">
                        </mat-form-field>
                        <button mat-raised-button class="col-sm-4"
                                *ngIf="fanSystemInteraction.fanSystemInteractionCriteria == 1"
                                (click)="this.chooseFanSystemInteractionCoefficient(fanSystemInteraction)"
                                [disabled]="fanSystemInteraction.fanSystemInteractionDescription == null">Select
                          Coefficient
                        </button>
                      </div>
                    </div>
                    <div class="col-sm-1"></div>
                    <div class="col">
                      <mat-form-field *ngIf="fanSystemInteraction.fanSystemInteractionCriteria == 2"
                                      style="width: 100%">
                        <textarea type="text" matTextareaAutosize matInput placeholder="Description"
                                  [(ngModel)]="fanSystemInteraction.fanSystemInteractionDescription"
                                  nullInputValidator
                                  #fanSystemInteractionDescription="ngModel">
                        </textarea>
                        <mat-error *ngIf="fanSystemInteractionDescription.errors">
                          Description Is Invalid
                        </mat-error>
                      </mat-form-field>
                      <mat-form-field *ngIf="fanSystemInteraction.fanSystemInteractionCriteria == 2"
                                      style="width: 100%">
                        <input type="number" step="any" matInput placeholder="loss coefficient (C)"
                               [(ngModel)]="fanSystemInteraction.ci"
                               nullInputValidator
                               #fanSystemInteractionCi="ngModel">
                        <mat-error *ngIf="fanSystemInteractionCi.errors">
                          Loss Coefficient Is Invalid
                        </mat-error>
                      </mat-form-field>
                    </div>
                  </div>
                </div>
                <br>
                <div id="inner-button" class="row">
                  <button mat-raised-button color="warn"
                          type="submit" (click)="this.removeFanSystemInteraction(i)">
                    Remove Fan-system interaction
                  </button>
                </div>
              </mat-expansion-panel>
            </div>
            <br>
            <div id="inner-button" class="row">
              <button mat-raised-button
                      type="submit" (click)="this.addFanSystemInteraction()"
                      [disabled]="request.fanSystemInteractionList.length==2 || request.fanSystemInteractionList.length==request.ductSectionList.length">
                Add Fan-system interaction
              </button>
            </div>
          </mat-expansion-panel>
        </div>
      </div>
      <div class="row">
        <div class="col">
          <mat-expansion-panel expanded="true">
            <h6 style="font-weight: bold;">Air terminal (diffuser, grille, louver ... etc)</h6>
            <div *ngFor="let airTerminal of request.airTerminalList;let i = index">
              <mat-expansion-panel expanded="true">
                <mat-expansion-panel-header>
                  <mat-panel-title>
                    Air Terminal #{{i+1}}
                  </mat-panel-title>
                </mat-expansion-panel-header>
                <div class="row">
                  <mat-form-field class="col" style="width: 16.5%">
                    <textarea type="text" matTextareaAutosize matInput placeholder="Type"
                              [(ngModel)]="airTerminal.airTerminalDescription"
                              nullInputValidator
                              #airTerminalDescription="ngModel">
                    </textarea>
                    <mat-error *ngIf="airTerminalDescription.errors">
                      Description Is Invalid
                    </mat-error>
                  </mat-form-field>
                  <mat-form-field class="col" style="width: 16.5%">
                    <textarea type="text" matTextareaAutosize matInput placeholder="Model"
                              [(ngModel)]="airTerminal.model"
                              nullInputValidator
                              #airTerminalModel="ngModel">
                    </textarea>
                    <mat-error *ngIf="airTerminalModel.errors">
                      Model Is Invalid
                    </mat-error>
                  </mat-form-field>
                  <mat-form-field class="col" style="width: 16.5%">
                    <input type="number" step="any" matInput placeholder="Flow Rate"
                           [(ngModel)]="airTerminal.terminalRateInput"
                           nullInputValidator
                           #terminalRateInput="ngModel">
                    <mat-error *ngIf="terminalRateInput.errors">
                      Flow Rate Is Invalid
                    </mat-error>
                  </mat-form-field>
                  <mat-dialog-content class="col" style="width: 16.5%">
                    <br>
                    <div
                      [innerHtml]="this.getTerminalRateUnit(request.units.uf,airTerminal).replace('^', '&sup')"></div>
                  </mat-dialog-content>
                  <mat-form-field class="col" style="width: 16.5%">
                    <input type="number" step="any" matInput placeholder="Pressure Loss"
                           [(ngModel)]="airTerminal.terminalPressureDropInput"
                           nullInputValidator
                           #terminalPressureDropInput="ngModel">
                    <mat-error *ngIf="terminalPressureDropInput.errors">
                      Pressure Drop Is Invalid
                    </mat-error>
                  </mat-form-field>
                  <mat-dialog-content class="col" style="width: 16.5%">
                    <br>
                    <div
                      [innerHtml]="this.getTerminalRateUnit(request.units.uf,airTerminal).replace('^', '&sup')"></div>
                  </mat-dialog-content>
                </div>
                <br>
                <div id="inner-button" class="row">
                  <button mat-raised-button color="warn"
                          type="submit" (click)="this.removeTerminal(i)">
                    Remove Terminal
                  </button>
                </div>
              </mat-expansion-panel>
            </div>
            <br>
            <div id="inner-button" class="row">
              <button mat-raised-button type="submit"
                      (click)="this.addTerminal()">Add New Terminal
              </button>
            </div>
          </mat-expansion-panel>
        </div>
      </div>
      <br>
      <div class="row">
        <div class="col" style="width: 33%"></div>
        <mat-expansion-panel expanded="true" style="width: 33%">
          <div class="row">
            <mat-form-field class="col" style="width: 45%">
              <input type="number" step="any" matInput placeholder="Fan Flow Rate"
                     [(ngModel)]="request.fanRate.fanRateInput"
                     nullInputValidator
                     #fanRateInput="ngModel">
              <mat-error *ngIf="fanRateInput.errors">
                Fan Flow Rate Is Invalid
              </mat-error>
            </mat-form-field>
            <mat-dialog-content class="col" style="width: 45%">
              <br>
              <div [innerHtml]="this.getFanRateUnit(request.units.uf).replace('^', '&sup')"></div>
            </mat-dialog-content>
          </div>
        </mat-expansion-panel>
        <div class="col" style="width: 33%"></div>
      </div>
    </div>
  </mat-expansion-panel>
  <br *ngIf="!error">
  <div id="inner-error-message" class="row" *ngIf="error">
    {{errorMessage.substring(errorMessage.lastIndexOf("-")+1)}}
  </div>
  <div id="inner-button" class="row">
    <button mat-raised-button type="submit" (click)="loadInput()">Load Input</button>
    <button mat-raised-button type="submit" (click)="saveInput()">Save Input</button>
    <button mat-raised-button type="submit" color="warn" (click)="resetAllData()">Reset All Data</button>
  </div>
  <br>
  <div id="inner-button" class="row">
    <button mat-raised-button type="submit" (click)="calculate()">Calculate</button>
  </div>
  <br>
</div>
</body>
<body *ngIf="resultAvailable">
<div id="reportPdf">
  <h5 style="font-weight: bold;">Output Report</h5>
  <mat-expansion-panel expanded="true" class="data-border-rectangular">
    <mat-expansion-panel expanded="true" class="data-border-rectangular">
      <div class="row">
        <mat-form-field class="col" style="width: 25%">
          <textarea type="text" matTextareaAutosize matInput readonly placeholder="Project"
                    [(ngModel)]="response.project">
          </textarea>
        </mat-form-field>
        <mat-form-field class="col" readonly style="width: 25%">
          <textarea type="text" matTextareaAutosize matInput placeholder="System"
                    [(ngModel)]="response.system">
          </textarea>
        </mat-form-field>
        <mat-form-field class="col" readonly style="width: 25%">
          <textarea type="text" matTextareaAutosize matInput placeholder="Fan Ref."
                    [(ngModel)]="response.pumpRef">
          </textarea>
        </mat-form-field>
        <mat-form-field class="col" readonly style="width: 25%">
          <textarea type="text" matTextareaAutosize matInput placeholder="Date"
                    [(ngModel)]="response.date">
          </textarea>
        </mat-form-field>
      </div>
    </mat-expansion-panel>
    <br>
    <mat-expansion-panel expanded="true" class="data-border-rectangular">
      <div class="data-border-rectangular">
        <u>Important Remark</u>
        <div>1- Pressure drop in straight duct is calculated using the most accurate method (Darcy-Weisbach equation).
        </div>
        <div>2- Pressure drop in fittings, dampers ... etc is calculated using loss coefficient (C) which depends on
          geometry and size.
        </div>
      </div>
      <br>
      <div class="row">
        <div class="col">
          <mat-expansion-panel expanded="true">
            <mat-expansion-panel-header>
              <mat-panel-title>
                <h6 style="font-weight: bold">Duct Sections</h6>
              </mat-panel-title>
            </mat-expansion-panel-header>
            <div *ngFor="let ductSection of response.ductSectionResponseList;let i = index">
              <mat-expansion-panel expanded="true" class="data-border-rectangular">
                <mat-expansion-panel-header>
                  <mat-panel-title>
                    Duct Section #{{i+1}}
                  </mat-panel-title>
                </mat-expansion-panel-header>
                <div class="row">
                  <div class="col" style="width: 25%"></div>
                  <mat-form-field class="col" style="width: 50%">
                    <textarea type="text" matTextareaAutosize matInput readonly placeholder="Duct Section Id"
                              [(ngModel)]="ductSection.o1">
                    </textarea>
                  </mat-form-field>
                  <div class="col" style="width: 25%"></div>
                </div>
                <div class="row">
                  <mat-form-field *ngIf="request.ductSectionList[i].shp == 1" class="col" style="width: 0.09%">
                    <textarea type="text" matTextareaAutosize matInput readonly placeholder="Duct Height"
                              [(ngModel)]="ductSection.o3">
                    </textarea>
                  </mat-form-field>
                  <mat-form-field *ngIf="request.ductSectionList[i].shp == 1" class="col" style="width: 0.09%">
                    <textarea type="text" matTextareaAutosize matInput readonly placeholder="Duct Width"
                              [(ngModel)]="ductSection.o4">
                    </textarea>
                  </mat-form-field>
                  <mat-form-field id="units-style" *ngIf="request.ductSectionList[i].shp == 1" class="col"
                                  style="width: 0.09%">
                    <textarea type="text" matTextareaAutosize matInput readonly
                              [(ngModel)]="ductSection.tx1">
                    </textarea>
                  </mat-form-field>
                  <div class="col" *ngIf="request.ductSectionList[i].shp == 2" style="width: 0.09%"></div>
                  <div class="col" *ngIf="request.ductSectionList[i].shp == 2" style="width: 0.09%"></div>
                  <div class="col" *ngIf="request.ductSectionList[i].shp == 2" style="width: 0.09%"></div>
                  <mat-form-field *ngIf="request.ductSectionList[i].shp == 2" class="col" style="width: 0.09%">
                    <textarea type="text" matTextareaAutosize matInput readonly placeholder="Duct Diameter"
                              [(ngModel)]="ductSection.o5">
                    </textarea>
                  </mat-form-field>
                  <mat-form-field id="units-style" *ngIf="request.ductSectionList[i].shp == 2" class="col"
                                  style="width: 0.09%">
                    <textarea type="text" matTextareaAutosize matInput readonly
                              [(ngModel)]="ductSection.tx1">
                    </textarea>
                  </mat-form-field>
                  <div class="col" *ngIf="request.ductSectionList[i].shp == 1" style="width: 0.09%"></div>
                  <div class="col" *ngIf="request.ductSectionList[i].shp == 1" style="width: 0.09%"></div>
                  <mat-form-field class="col" style="width: 0.09%">
                    <textarea type="text" matTextareaAutosize matInput readonly placeholder="Duct Thickness"
                              [(ngModel)]="ductSection.o6">
                    </textarea>
                  </mat-form-field>
                  <mat-form-field id="units-style" class="col" style="width: 0.09%">
                    <textarea type="text" matTextareaAutosize matInput readonly
                              [(ngModel)]="ductSection.tx1">
                    </textarea>
                  </mat-form-field>
                  <mat-form-field class="col" style="width: 0.09%">
                    <textarea type="text" matTextareaAutosize matInput readonly placeholder="Flow Rate"
                              [(ngModel)]="ductSection.o7">
                    </textarea>
                  </mat-form-field>
                  <mat-dialog-content class="col" style="width: 0.09%">
                    <br>
                    <div [innerHtml]="ductSection.tx2.replace('^', '&sup')"></div>
                  </mat-dialog-content>
                  <mat-form-field class="col" style="width: 0.09%">
                    <textarea type="text" matTextareaAutosize matInput readonly placeholder="Flow Velocity"
                              [(ngModel)]="ductSection.o8">
                    </textarea>
                  </mat-form-field>
                  <mat-form-field id="units-style" class="col" style="width: 0.09%">
                    <textarea type="text" matTextareaAutosize matInput readonly
                              [(ngModel)]="ductSection.tx3">
                    </textarea>
                  </mat-form-field>
                </div>
                <div class="row">
                  <div class="col" style="font-size: 13px">
                    <u>Straight Run</u>
                  </div>
                </div>
                <div class="row">
                  <mat-form-field class="col" style="width: 25%">
                    <textarea type="text" matTextareaAutosize matInput readonly placeholder="Length"
                              [(ngModel)]="ductSection.o88">
                    </textarea>
                  </mat-form-field>
                  <mat-form-field id="units-style" class="col" style="width: 25%">
                    <textarea type="text" matTextareaAutosize matInput readonly
                              [(ngModel)]="ductSection.tx4">
                    </textarea>
                  </mat-form-field>
                  <mat-form-field class="col" style="width: 25%">
                    <textarea type="text" matTextareaAutosize matInput readonly placeholder="Pressure Loss"
                              [(ngModel)]="ductSection.o9">
                    </textarea>
                  </mat-form-field>
                  <mat-form-field id="units-style" class="col" style="width: 25%">
                    <textarea type="text" matTextareaAutosize matInput readonly
                              [(ngModel)]="response.tx5">
                    </textarea>
                  </mat-form-field>
                </div>
                <div class="row">
                  <mat-expansion-panel class="col data-border-rectangular" expanded="true">
                    <mat-expansion-panel-header>
                      <mat-panel-title>
                        Fittings
                      </mat-panel-title>
                    </mat-expansion-panel-header>
                    <div class="row" *ngIf="ductSection.fittingResponseList.length>0">
                      <div class="col" style="font-size: 13px">
                        Type
                      </div>
                      <div class="col-sm-2" style="font-size: 13px">
                        C
                      </div>
                      <div class="col-sm-2" style="font-size: 13px">
                        Qty
                      </div>
                      <div class="col-sm-2" style="font-size: 13px">
                        Pressure Loss
                      </div>
                      <div class="col-sm-2"></div>
                    </div>
                    <div class="row" *ngFor="let fitting of ductSection.fittingResponseList">
                      <mat-form-field class="col" style="width: 20%;">
                        <textarea type="text" matTextareaAutosize matInput readonly
                                  [(ngModel)]="fitting.o10">
                        </textarea>
                      </mat-form-field>
                      <mat-form-field class="col-sm-2" style="width: 20%">
                        <textarea type="text" matTextareaAutosize matInput readonly
                                  [(ngModel)]="fitting.o11">
                        </textarea>
                      </mat-form-field>
                      <mat-form-field class="col-sm-2" style="width: 20%">
                        <textarea type="text" matTextareaAutosize matInput readonly
                                  [(ngModel)]="fitting.o12">
                        </textarea>
                      </mat-form-field>
                      <mat-form-field class="col-sm-2" style="width: 20%">
                        <textarea type="text" matTextareaAutosize matInput readonly
                                  [(ngModel)]="fitting.o13">
                        </textarea>
                      </mat-form-field>
                      <mat-form-field id="units-style" class="col-sm-2" style="width: 20%">
                        <textarea type="text" matTextareaAutosize matInput readonly
                                  [(ngModel)]="response.tx5">
                        </textarea>
                      </mat-form-field>
                    </div>
                  </mat-expansion-panel>
                  <mat-expansion-panel class="col data-border-rectangular" expanded="true">
                    <mat-expansion-panel-header>
                      <mat-panel-title>
                        Dampers & Obstructions
                      </mat-panel-title>
                    </mat-expansion-panel-header>
                    <div class="row" *ngIf="ductSection.dampersAndObstructionsResponseList.length>0">
                      <div class="col" style="font-size: 13px">
                        Type
                      </div>
                      <div class="col-sm-2" style="font-size: 13px">
                        C
                      </div>
                      <div class="col-sm-2" style="font-size: 13px">
                        Qty
                      </div>
                      <div class="col-sm-2" style="font-size: 13px">
                        Pressure Loss
                      </div>
                      <div class="col-sm-2"></div>
                    </div>
                    <div class="row"
                         *ngFor="let dampersAndObstructions of ductSection.dampersAndObstructionsResponseList">
                      <mat-form-field class="col" style="width: 20%">
                        <textarea type="text" matTextareaAutosize matInput readonly
                                  [(ngModel)]="dampersAndObstructions.o14">
                        </textarea>
                      </mat-form-field>
                      <mat-form-field class="col-sm-2" style="width: 20%">
                        <textarea type="text" matTextareaAutosize matInput readonly
                                  [(ngModel)]="dampersAndObstructions.o15">
                        </textarea>
                      </mat-form-field>
                      <mat-form-field class="col-sm-2" style="width: 20%">
                        <textarea type="text" matTextareaAutosize matInput readonly
                                  [(ngModel)]="dampersAndObstructions.o16">
                        </textarea>
                      </mat-form-field>
                      <mat-form-field class="col-sm-2" style="width: 20%">
                        <textarea type="text" matTextareaAutosize matInput readonly
                                  [(ngModel)]="dampersAndObstructions.o17">
                        </textarea>
                      </mat-form-field>
                      <mat-form-field id="units-style" class="col-sm-2" style="width: 20%">
                        <textarea type="text" matTextareaAutosize matInput readonly
                                  [(ngModel)]="response.tx5">
                        </textarea>
                      </mat-form-field>
                    </div>
                  </mat-expansion-panel>
                </div>
                <br>
                <div class="row">
                  <mat-form-field class="col" style="width: 12.5%">
                    <textarea type="text" matTextareaAutosize matInput readonly placeholder="Total"
                              [(ngModel)]="ductSection.o25">
                    </textarea>
                  </mat-form-field>
                  <mat-form-field id="units-style" class="col" style="width: 12.5%">
                    <textarea type="text" matTextareaAutosize matInput readonly
                              [(ngModel)]="response.tx5">
                    </textarea>
                  </mat-form-field>
                  <mat-form-field class="col" style="width: 12.5%">
                    <textarea type="text" matTextareaAutosize matInput readonly placeholder="Total"
                              [(ngModel)]="ductSection.o26">
                    </textarea>
                  </mat-form-field>
                  <mat-form-field id="units-style" class="col" style="width: 12.5%">
                    <textarea type="text" matTextareaAutosize matInput readonly
                              [(ngModel)]="response.tx5">
                    </textarea>
                  </mat-form-field>
                </div>
                <div class="row">
                  <mat-expansion-panel class="col data-border-rectangular" expanded="true">
                    <mat-expansion-panel-header>
                      <mat-panel-title>
                        Duct-Mounted Equipment
                      </mat-panel-title>
                    </mat-expansion-panel-header>
                    <div class="row" *ngIf="ductSection.ductMountedEquipmentResponseList.length>0">
                      <div class="col" style="font-size: 13px">
                        Type
                      </div>
                      <div class="col-sm-2" style="font-size: 13px">
                        C
                      </div>
                      <div class="col-sm-2" style="font-size: 13px">
                        Qty
                      </div>
                      <div class="col-sm-2" style="font-size: 13px">
                        Pressure Loss
                      </div>
                      <div class="col-sm-2"></div>
                    </div>
                    <div class="row" *ngFor="let ductMountedEquipment of ductSection.ductMountedEquipmentResponseList">
                      <mat-form-field class="col" style="width: 20%">
                        <textarea type="text" matTextareaAutosize matInput readonly
                                  [(ngModel)]="ductMountedEquipment.o18">
                        </textarea>
                      </mat-form-field>
                      <mat-form-field class="col-sm-2" style="width: 20%">
                        <textarea type="text" matTextareaAutosize matInput readonly
                                  [(ngModel)]="ductMountedEquipment.o19">
                        </textarea>
                      </mat-form-field>
                      <mat-form-field class="col-sm-2" style="width: 20%">
                        <textarea type="text" matTextareaAutosize matInput readonly
                                  [(ngModel)]="ductMountedEquipment.o20">
                        </textarea>
                      </mat-form-field>
                      <mat-form-field class="col-sm-2" style="width: 20%">
                        <textarea type="text" matTextareaAutosize matInput readonly
                                  [(ngModel)]="ductMountedEquipment.o21">
                        </textarea>
                      </mat-form-field>
                      <mat-form-field id="units-style" class="col-sm-2" style="width: 20%">
                        <textarea type="text" matTextareaAutosize matInput readonly
                                  [(ngModel)]="response.tx5">
                        </textarea>
                      </mat-form-field>
                    </div>
                  </mat-expansion-panel>
                  <mat-expansion-panel class="col data-border-rectangular" expanded="true">
                    <mat-expansion-panel-header>
                      <mat-panel-title>
                        Special Components
                      </mat-panel-title>
                    </mat-expansion-panel-header>
                    <div class="row" *ngIf="ductSection.specialComponentResponseList.length>0">
                      <div class="col" style="font-size: 13px">
                        Type
                      </div>
                      <div class="col-sm-2" style="font-size: 13px">
                        Qty
                      </div>
                      <div class="col-sm-2" style="font-size: 13px">
                        Pressure Loss
                      </div>
                      <div class="col-sm-2"></div>
                    </div>
                    <div class="row" *ngFor="let specialComponent of ductSection.specialComponentResponseList">
                      <mat-form-field class="col" style="width: 25%">
                        <textarea type="text" matTextareaAutosize matInput readonly
                                  [(ngModel)]="specialComponent.o22">
                        </textarea>
                      </mat-form-field>
                      <mat-form-field class="col-sm-2" style="width: 25%">
                        <textarea type="text" matTextareaAutosize matInput readonly
                                  [(ngModel)]="specialComponent.o23">
                        </textarea>
                      </mat-form-field>
                      <mat-form-field class="col-sm-2" style="width: 25%">
                        <textarea type="text" matTextareaAutosize matInput readonly
                                  [(ngModel)]="specialComponent.o24">
                        </textarea>
                      </mat-form-field>
                      <mat-form-field id="units-style" class="col-sm-2" style="width: 25%">
                        <textarea type="text" matTextareaAutosize matInput readonly
                                  [(ngModel)]="response.tx5">
                        </textarea>
                      </mat-form-field>
                    </div>
                  </mat-expansion-panel>
                </div>
                <br>
                <div class="row">
                  <mat-form-field class="col" style="width: 12.5%">
                    <textarea type="text" matTextareaAutosize matInput readonly placeholder="Total"
                              [(ngModel)]="ductSection.o27">
                    </textarea>
                  </mat-form-field>
                  <mat-form-field id="units-style" class="col" style="width: 12.5%">
                    <textarea type="text" matTextareaAutosize matInput readonly
                              [(ngModel)]="response.tx5">
                    </textarea>
                  </mat-form-field>
                  <mat-form-field class="col" style="width: 12.5%">
                    <textarea type="text" matTextareaAutosize matInput readonly placeholder="Total"
                              [(ngModel)]="ductSection.o28">
                    </textarea>
                  </mat-form-field>
                  <mat-form-field id="units-style" class="col" style="width: 12.5%">
                    <textarea type="text" matTextareaAutosize matInput readonly
                              [(ngModel)]="response.tx5">
                    </textarea>
                  </mat-form-field>
                </div>
              </mat-expansion-panel>
            </div>
          </mat-expansion-panel>
        </div>
      </div>
      <br>
      <div class="row">
        <div class="col">
          <mat-expansion-panel expanded="true">
            <h6 style="font-weight: bold">Duct Sections Pressure Loss Summary</h6>
            <mat-expansion-panel class="row data-border-rectangular" expanded="true">
              <div class="row">
                <div class="col" align="center" style="font-size: 13px"><u>Straight Duct</u></div>
                <div class="col" align="center" style="font-size: 13px"><u>Fittings</u></div>
                <div class="col" align="center" style="font-size: 13px"><u>Dampers & Obstructions</u></div>
                <div class="col" align="center" style="font-size: 13px"><u>Duct-Mounted Equipments</u></div>
                <div class="col" align="center" style="font-size: 13px"><u>Special Components</u></div>
                <div class="col" align="center" style="font-size: 13px"><u>Total Pressure Loss</u></div>
              </div>
              <div class="row">
                <mat-form-field class="col" style="width: 0.083%">
                  <textarea type="text" matTextareaAutosize matInput readonly
                            [(ngModel)]="response.o32">
                  </textarea>
                </mat-form-field>
                <mat-dialog-content class="col" style="width: 0.083%">
                  <br>
                  <div [innerHtml]="response.tx5.replace('^', '&sup')"></div>
                </mat-dialog-content>
                <mat-form-field class="col" style="width: 0.083%">
                  <textarea type="text" matTextareaAutosize matInput readonly
                            [(ngModel)]="response.o33">
                  </textarea>
                </mat-form-field>
                <mat-dialog-content class="col" style="width: 0.083%">
                  <br>
                  <div [innerHtml]="response.tx5.replace('^', '&sup')"></div>
                </mat-dialog-content>
                <mat-form-field class="col" style="width: 0.083%">
                  <textarea type="text" matTextareaAutosize matInput readonly
                            [(ngModel)]="response.o34">
                  </textarea>
                </mat-form-field>
                <mat-dialog-content class="col" style="width: 0.083%">
                  <br>
                  <div [innerHtml]="response.tx5.replace('^', '&sup')"></div>
                </mat-dialog-content>
                <mat-form-field class="col" style="width: 0.083%">
                  <textarea type="text" matTextareaAutosize matInput readonly
                            [(ngModel)]="response.o35">
                  </textarea>
                </mat-form-field>
                <mat-dialog-content class="col" style="width: 0.083%">
                  <br>
                  <div [innerHtml]="response.tx5.replace('^', '&sup')"></div>
                </mat-dialog-content>
                <mat-form-field class="col" style="width: 0.083%">
                  <textarea type="text" matTextareaAutosize matInput readonly
                            [(ngModel)]="response.o36">
                  </textarea>
                </mat-form-field>
                <mat-dialog-content class="col" style="width: 0.083%">
                  <br>
                  <div [innerHtml]="response.tx5.replace('^', '&sup')"></div>
                </mat-dialog-content>
                <mat-form-field class="col" style="width: 0.083%">
                  <textarea type="text" matTextareaAutosize matInput readonly
                            [(ngModel)]="response.o37">
                  </textarea>
                </mat-form-field>
                <mat-dialog-content class="col" style="width: 0.083%">
                  <br>
                  <div [innerHtml]="response.tx5.replace('^', '&sup')"></div>
                </mat-dialog-content>
              </div>
            </mat-expansion-panel>
          </mat-expansion-panel>
        </div>
      </div>
      <br>
      <div class="row">
        <div class="col">
          <mat-expansion-panel expanded="true">
            <mat-expansion-panel-header>
              <mat-panel-title>
                <h6 style="font-weight: bold">Fan-System Interaction</h6>
              </mat-panel-title>
            </mat-expansion-panel-header>
            <mat-expansion-panel class="data-border-rectangular" expanded="true">
              <div class="row" *ngIf="response.fanSystemInteractionResponseList.length>0">
                <div class="col" style="width: 19%"></div>
                <div class="col" style="width: 19%;font-size: 13px">Type</div>
                <div class="col" style="width: 19%;font-size: 13px">C</div>
                <div class="col" style="width: 19%;font-size: 13px">Pressure Loss</div>
                <div class="col" style="width: 19%"></div>
              </div>
              <div class="row"
                   *ngFor="let fanSystemInteraction of response.fanSystemInteractionResponseList;let i = index">
                <mat-form-field class="col" style="width: 19%">
                  <textarea type="text" matTextareaAutosize matInput readonly
                            value="Fan-System Interaction {{i+1}}">
                  </textarea>
                </mat-form-field>
                <mat-form-field class="col" style="width: 19%">
                  <textarea type="text" matTextareaAutosize matInput readonly
                            [(ngModel)]="fanSystemInteraction.o29">
                  </textarea>
                </mat-form-field>
                <mat-form-field class="col" style="width: 19%">
                  <textarea type="text" matTextareaAutosize matInput readonly
                            [(ngModel)]="fanSystemInteraction.o30">
                  </textarea>
                </mat-form-field>
                <mat-form-field class="col" style="width: 19%">
                  <textarea type="text" matTextareaAutosize matInput readonly
                            [(ngModel)]="fanSystemInteraction.o31">
                  </textarea>
                </mat-form-field>
                <mat-form-field id="units-style" class="col" style="width: 19%">
                  <textarea type="text" matTextareaAutosize matInput readonly
                            [(ngModel)]="response.tx5">
                  </textarea>
                </mat-form-field>
              </div>
              <br>
              <div class="row">
                <div class="col" style="width: 25%"></div>
                <mat-form-field class="col" style="width: 25%">
                  <textarea type="text" matTextareaAutosize matInput readonly placeholder="Total"
                            [(ngModel)]="response.o45">
                  </textarea>
                </mat-form-field>
                <mat-form-field id="units-style" class="col" style="width: 25%">
                  <textarea type="text" matTextareaAutosize matInput readonly
                            [(ngModel)]="response.tx5">
                  </textarea>
                </mat-form-field>
                <div class="col" style="width: 25%"></div>
              </div>
            </mat-expansion-panel>
          </mat-expansion-panel>
        </div>
      </div>
      <br>
      <div class="row">
        <div class="col">
          <mat-expansion-panel expanded="true">
            <mat-expansion-panel-header>
              <mat-panel-title>
                <h6 style="font-weight: bold">Air Terminals</h6>
              </mat-panel-title>
            </mat-expansion-panel-header>
            <mat-expansion-panel class="data-border-rectangular" expanded="true">
              <div class="row" *ngIf="response.airTerminalResponseList.length>0">
                <div class="col" style="width: 16%"></div>
                <div class="col" style="width: 16%;font-size: 13px">Type</div>
                <div class="col" style="width: 16%;font-size: 13px">Model</div>
                <div class="col" style="width: 16%;font-size: 13px">Flow Rate</div>
                <div class="col" style="width: 16%;font-size: 13px">Pressure Loss</div>
                <div class="col" style="width: 16%"></div>
              </div>
              <div class="row" *ngFor="let airTerminal of response.airTerminalResponseList;let i = index">
                <mat-form-field class="col" style="width: 16%">
                  <textarea type="text" matTextareaAutosize matInput readonly
                            value="Air Terminal {{i+1}}">
                  </textarea>
                </mat-form-field>
                <mat-form-field class="col" style="width: 16%">
                  <textarea type="text" matTextareaAutosize matInput readonly
                            [(ngModel)]="airTerminal.o38">
                  </textarea>
                </mat-form-field>
                <mat-form-field class="col" style="width: 16%">
                  <textarea type="text" matTextareaAutosize matInput readonly
                            [(ngModel)]="airTerminal.o39">
                  </textarea>
                </mat-form-field>
                <mat-form-field class="col" style="width: 16%">
                  <textarea type="text" matTextareaAutosize matInput readonly
                            [(ngModel)]="airTerminal.o40">
                  </textarea>
                </mat-form-field>
                <mat-form-field class="col" style="width: 16%">
                  <textarea type="text" matTextareaAutosize matInput readonly
                            [(ngModel)]="airTerminal.o41">
                  </textarea>
                </mat-form-field>
                <mat-form-field id="units-style" class="col" style="width: 16%">
                  <textarea type="text" matTextareaAutosize matInput readonly
                            [(ngModel)]="response.tx5">
                  </textarea>
                </mat-form-field>
              </div>
              <br>
              <div class="row">
                <div class="col" style="width: 25%"></div>
                <mat-form-field class="col" style="width: 25%">
                  <textarea type="text" matTextareaAutosize matInput readonly placeholder="Total"
                            [(ngModel)]="response.o42">
                  </textarea>
                </mat-form-field>
                <mat-form-field id="units-style" class="col" style="width: 25%">
                  <textarea type="text" matTextareaAutosize matInput readonly
                            [(ngModel)]="response.tx5">
                  </textarea>
                </mat-form-field>
                <div class="col" style="width: 25%"></div>
              </div>
            </mat-expansion-panel>
          </mat-expansion-panel>
        </div>
      </div>
      <br>
      <div class="row">
        <div class="col">
          <mat-expansion-panel expanded="true">
            <h6 style="font-weight: bold">Fan ESP & Flow</h6>
            <mat-expansion-panel class="row data-border-rectangular" expanded="true">
              <div class="row">
                <mat-form-field class="col" style="width: 24%">
                  <textarea type="text" matTextareaAutosize matInput readonly placeholder="Fan Flow Rate"
                         [(ngModel)]="response.o43">
                  </textarea>
                </mat-form-field>
                <mat-dialog-content class="col" style="width: 24%">
                  <br>
                  <div [innerHtml]="response.ductSectionResponseList[0].tx2.replace('^', '&sup')"></div>
                </mat-dialog-content>
                <mat-form-field class="col" style="width: 24%">
                  <textarea type="text" matTextareaAutosize matInput readonly placeholder="Fan Esp"
                         [(ngModel)]="response.o44">
                  </textarea>
                </mat-form-field>
                <mat-dialog-content class="col" style="width: 24%">
                  <br>
                  <div [innerHtml]="response.tx5.replace('^', '&sup')"></div>
                </mat-dialog-content>
              </div>
            </mat-expansion-panel>
          </mat-expansion-panel>
        </div>
      </div>
    </mat-expansion-panel>
  </mat-expansion-panel>
</div>
<br>
<div id="inner-button" class="row">
  <button mat-raised-button type="submit" (click)="generatePDF()">Download PDF</button>
  <button mat-raised-button color="warn" type="submit" (click)="backToInputPage()">Back</button>
</div>
<br>
</body>
</html>
